<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>CornerPoint.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">debugAndroidTest</a> &gt; <a href="index.source.html" class="el_package">de.uni_stuttgart.informatik.sopra.fieldManager.data</a> &gt; <span class="el_source">CornerPoint.java</span></div><h1>CornerPoint.java</h1><pre class="source lang-java linenums">package de.uni_stuttgart.informatik.sopra.sopraapp.data;

import java.io.Serializable;

import de.uni_stuttgart.informatik.sopra.sopraapp.data.geoData.MathUtility;
import de.uni_stuttgart.informatik.sopra.sopraapp.data.geoData.UTMCoordinate;
import de.uni_stuttgart.informatik.sopra.sopraapp.data.geoData.Vector;
import de.uni_stuttgart.informatik.sopra.sopraapp.data.geoData.WGS84Coordinate;
import de.uni_stuttgart.informatik.sopra.sopraapp.data.geoData.WGS84UTMConverter;

/**
 * Created by Christian on 13.11.2017.
 */

public class CornerPoint implements Serializable {

    private WGS84Coordinate wgs;
    private UTMCoordinate utm;

    /**
     * the angle at this cornerpoint
     * on the right side following the input path
     * as radian
     */
    private double angle;

<span class="fc" id="L27">    public CornerPoint(double latitude, double logitude) {</span>
<span class="pc bpc" id="L28" title="2 of 4 branches missed.">        if (latitude != Double.NaN &amp;&amp; logitude != Double.NaN) {</span>
<span class="fc" id="L29">            wgs = new WGS84Coordinate(latitude, logitude);</span>
<span class="fc" id="L30">            utm = WGS84UTMConverter.convert(wgs);</span>
        }
<span class="fc" id="L32">    }</span>

    public void calculateAngle(CornerPoint before, CornerPoint after) {

<span class="fc" id="L36">        UTMCoordinate utmBefore = before.getUtm();</span>
<span class="fc" id="L37">        UTMCoordinate utmAfter = after.getUtm();</span>
<span class="pc bpc" id="L38" title="2 of 4 branches missed.">        if(utm.getZone() == utmBefore.getZone() &amp;&amp; utm.getZone() == utmAfter.getZone()) {</span>
<span class="fc" id="L39">            Vector v_before = new Vector((utmBefore.getEasting()- utm.getEasting()), (utmBefore.getNorthing()-utm.getNorthing()));</span>
<span class="fc" id="L40">            Vector v_after = new Vector((utmAfter.getEasting()- utm.getEasting()), (utmAfter.getNorthing()-utm.getNorthing()));</span>
<span class="pc bpc" id="L41" title="1 of 4 branches missed.">            if(v_before.getLength() == 0 || v_after.getLength() == 0) {</span>
<span class="fc" id="L42">            	angle = 0;</span>
<span class="fc" id="L43">            	return;</span>
            }
            //cos a = (v_a x v_b )/ (|v_a| * |v_b)|
<span class="fc" id="L46">            angle = Math.acos(MathUtility.scalarProduct(v_before,v_after)/(v_before.getLength() * v_after.getLength()));</span>

<span class="fc" id="L48">            Vector rotated = v_after.rotate(angle);</span>
<span class="fc bfc" id="L49" title="All 2 branches covered.">            if(rotated.equalDirection(v_before)) {</span>
<span class="fc" id="L50">                angle = 2*Math.PI - angle;</span>
            }

            //maybe remove itself if angle = 180Â°
        } else {
            //TODO
        }

<span class="fc" id="L58">    }</span>

    public WGS84Coordinate getWGS() {
<span class="fc" id="L61">        return wgs;</span>
    }

    public UTMCoordinate getUtm() {
<span class="fc" id="L65">        return utm;</span>
    }

    public double getAngle() {
<span class="fc" id="L69">        return angle;</span>
    }

    @Override
    public boolean equals(Object o ) {
<span class="pc bpc" id="L74" title="1 of 2 branches missed.">        if (o instanceof CornerPoint) {</span>
<span class="fc" id="L75">            return utm.equals( ((CornerPoint) o).getUtm());</span>
        } else {
<span class="nc" id="L77">            return false;</span>
        }
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.4.201502262128</span>Generated by the Android Gradle plugin 3.0.1</div></body></html>